<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="12.0" DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">

  <PropertyGroup>
    <ExtMetaDir>$(MSBuildThisFileDirectory)</ExtMetaDir>
  </PropertyGroup>

  <PropertyGroup>
    <MetaVerbosity>$(Verbosity)</MetaVerbosity>
  </PropertyGroup>

  <PropertyGroup>
    <Platform Condition="'$(Platform)'==''">all</Platform>
  </PropertyGroup>
  
  <!--Creates a clean "stack frame" for recursive calls by clearing out unwanted inherited properties-->
  <!--see: https://github.com/Microsoft/msbuild/issues/902 -->
  <PropertyGroup>
    <MetaPlatform Condition="'$(_MetaPlatform)'!=''">$(_MetaPlatform)</MetaPlatform>
    <ClearRecursiveFrame>$(ClearRecursiveFrame)_MetaPlatform=;</ClearRecursiveFrame>
  </PropertyGroup>

  <!--library platform ids-->
  <PropertyGroup>

    <!--abstract platform ids-->
    <LeafPlatformId>leaf</LeafPlatformId>
    <MetaPlatformId>meta</MetaPlatformId>
    <GroupPlatformId>group</GroupPlatformId>
  </PropertyGroup>

  <!--ad-hoc platform group-->
  <PropertyGroup Condition="$(Plat.Contains(';'))">
    <ChildPlatforms>$(Plat)</ChildPlatforms>
    <PlatformType>$(GroupPlatformId)</PlatformType>
  </PropertyGroup>

  <!--ChildPlatform: Property -> Items-->
  <ItemGroup>
    <ChildPlatforms Include="$(ChildPlatforms)"/>
  </ItemGroup>

</Project>